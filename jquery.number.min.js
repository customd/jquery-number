(function(e){function d(i,h){if(this.createTextRange){var g=this.createTextRange();g.collapse(true);g.moveStart("character",i);g.moveEnd("character",h-i);g.select()}else{if(this.setSelectionRange){this.focus();this.setSelectionRange(i,h)}}}function b(i){var l=this.value.length;i=(i.toLowerCase()=="start"?"Start":"End");if(document.selection){var g=document.selection.createRange(),h,j,k;h=g.duplicate();h.expand("textedit");h.setEndPoint("EndToEnd",g);j=h.text.length-g.text.length;k=j+g.text.length;return i=="Start"?j:k}else{if(typeof(this["selection"+i])!="undefined"){l=this["selection"+i]}}return l}var a={codes:{46:127,188:44,109:45,190:46,191:47,192:96,220:92,222:39,221:93,219:91,173:45,187:61,186:59,189:45,110:46},shifts:{96:"~",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",48:")",45:"_",61:"+",91:"{",93:"}",92:"|",59:":",39:'"',44:"<",46:">",47:"?"}};e.fn.number=function(l,h,j,g){g=(typeof g==="undefined")?",":g;j=(typeof j==="undefined")?".":j;h=(typeof h==="undefined")?0:h;var m=("\\u"+("0000"+(j.charCodeAt(0).toString(16))).slice(-4)),k=new RegExp("[^"+m+"0-9]","g"),i=new RegExp(m,"g");if(l===true){if(this.is("input:text")){return this.on({"keydown.format":function(t){var u=e(this),r=u.data("numFormat"),o=(t.keyCode?t.keyCode:t.which),s="",n=b.apply(this,["start"]),q=b.apply(this,["end"]),p="",w=false;if(a.codes.hasOwnProperty(o)){o=a.codes[o]}if(!t.shiftKey&&(o>=65&&o<=90)){o+=32}else{if(!t.shiftKey&&(o>=69&&o<=105)){o-=48}else{if(t.shiftKey&&a.shifts.hasOwnProperty(o)){s=a.shifts[o]}}}if(s==""){s=String.fromCharCode(o)}if(o!=8&&o!=45&&o!=127&&s!=j&&!s.match(/[0-9]/)){var v=(t.keyCode?t.keyCode:t.which);if(v==46||v==8||v==127||v==9||v==27||v==13||((v==65||v==82||v==80||v==83||v==70||v==72||v==66||v==74||v==84||v==90||v==61||v==173||v==48)&&(t.ctrlKey||t.metaKey)===true)||((v==86||v==67||v==88)&&(t.ctrlKey||t.metaKey)===true)||((v>=35&&v<=39))||((v>=112&&v<=123))){return}t.preventDefault();return false}if(n==0&&q==this.value.length){if(o==8){n=q=1;this.value="";r.init=(h>0?-1:0);r.c=(h>0?-(h+1):0);d.apply(this,[0,0])}else{if(s==j){n=q=1;this.value="0"+j+(new Array(h+1).join("0"));r.init=(h>0?1:0);r.c=(h>0?-(h+1):0)}else{if(o==45){n=q=2;this.value="-0"+j+(new Array(h+1).join("0"));r.init=(h>0?1:0);r.c=(h>0?-(h+1):0);d.apply(this,[2,2])}else{r.init=(h>0?-1:0);r.c=(h>0?-(h):0)}}}}else{r.c=q-this.value.length}r.isPartialSelection=n==q?false:true;if(h>0&&s==j&&n==this.value.length-h-1){r.c++;r.init=Math.max(0,r.init);t.preventDefault();w=this.value.length+r.c}else{if(o==45&&(n!=0||this.value.indexOf("-")==0)){t.preventDefault()}else{if(s==j){r.init=Math.max(0,r.init);t.preventDefault()}else{if(h>0&&o==127&&n==this.value.length-h-1){t.preventDefault()}else{if(h>0&&o==8&&n==this.value.length-h){t.preventDefault();r.c--;w=this.value.length+r.c}else{if(h>0&&o==127&&n>this.value.length-h-1){if(this.value===""){return}if(this.value.slice(n,n+1)!="0"){p=this.value.slice(0,n)+"0"+this.value.slice(n+1);u.val(p)}t.preventDefault();w=this.value.length+r.c}else{if(h>0&&o==8&&n>this.value.length-h){if(this.value===""){return}if(this.value.slice(n-1,n)!="0"){p=this.value.slice(0,n-1)+"0"+this.value.slice(n);u.val(p)}t.preventDefault();r.c--;w=this.value.length+r.c}else{if(o==127&&this.value.slice(n,n+1)==g){t.preventDefault()}else{if(o==8&&this.value.slice(n-1,n)==g){t.preventDefault();r.c--;w=this.value.length+r.c}else{if(h>0&&n==q&&this.value.length>h+1&&n>this.value.length-h-1&&isFinite(+s)&&!t.metaKey&&!t.ctrlKey&&!t.altKey&&s.length===1){if(q===this.value.length){p=this.value.slice(0,n-1)}else{p=this.value.slice(0,n)+this.value.slice(n+1)}this.value=p;w=n}}}}}}}}}}if(w!==false){d.apply(this,[w,w])}u.data("numFormat",r)},"keyup.format":function(s){var r=e(this),p=r.data("numFormat"),o=(s.keyCode?s.keyCode:s.which),t=b.apply(this,["start"]),n=b.apply(this,["end"]),q;if(t===0&&n===0&&(o===189||o===109)){r.val("-"+r.val());t=1;p.c=1-this.value.length;p.init=1;r.data("numFormat",p);q=this.value.length+p.c;d.apply(this,[q,q])}if(this.value===""||(o<48||o>57)&&(o<96||o>105)&&o!==8&&o!==46&&o!==110){return}r.val(r.val());if(h>0){if(p.init<1){t=this.value.length-h-(p.init<0?1:0);p.c=t-this.value.length;p.init=1;r.data("numFormat",p)}else{if(t>this.value.length-h&&o!=8){p.c++;r.data("numFormat",p)}}}if(o==46&&!p.isPartialSelection){p.c++;r.data("numFormat",p)}q=this.value.length+p.c;d.apply(this,[q,q])},"paste.format":function(p){var o=e(this),n=p.originalEvent,q=null;if(window.clipboardData&&window.clipboardData.getData){q=window.clipboardData.getData("Text")}else{if(n.clipboardData&&n.clipboardData.getData){q=n.clipboardData.getData("text/plain")}}o.val(q);p.preventDefault();return false}}).each(function(){var n=e(this).data("numFormat",{c:-(h+1),decimals:h,thousands_sep:g,dec_point:j,regex_dec_num:k,regex_dec:i,init:this.value.indexOf(".")?true:false});if(this.value===""){return}n.val(n.val())})}else{return this.each(function(){var o=e(this),n=+o.text().replace(k,"").replace(i,".");o.number(!isFinite(n)?0:+n,h,j,g)})}}return this.text(e.number.apply(window,arguments))};var f=null,c=null;if(e.isPlainObject(e.valHooks.text)){if(e.isFunction(e.valHooks.text.get)){f=e.valHooks.text.get}if(e.isFunction(e.valHooks.text.set)){c=e.valHooks.text.set}}else{e.valHooks.text={}}e.valHooks.text.get=function(i){var k=e(i),h,g,j=k.data("numFormat");if(!j){if(e.isFunction(f)){return f(i)}else{return undefined}}else{if(i.value===""){return""}h=+(i.value.replace(j.regex_dec_num,"").replace(j.regex_dec,"."));return(i.value.indexOf("-")===0?"-":"")+(isFinite(h)?h:0)}};e.valHooks.text.set=function(h,k){var j=e(h),i=j.data("numFormat");if(!i){if(e.isFunction(c)){return c(h,k)}else{return undefined}}else{var g=e.number(k,i.decimals,i.dec_point,i.thousands_sep);return e.isFunction(c)?c(h,g):h.value=g}};e.number=function(l,i,o,j){j=(typeof j==="undefined")?(new Number(1000).toLocaleString()!=="1000"?new Number(1000).toLocaleString().charAt(1):""):j;o=(typeof o==="undefined")?new Number(0.1).toLocaleString().charAt(1):o;i=!isFinite(+i)?0:Math.abs(i);var k=("\\u"+("0000"+(o.charCodeAt(0).toString(16))).slice(-4));var g=("\\u"+("0000"+(j.charCodeAt(0).toString(16))).slice(-4));l=(l+"").replace(".",o).replace(new RegExp(g,"g"),"").replace(new RegExp(k,"g"),".").replace(new RegExp("[^0-9+-Ee.]","g"),"");var h=!isFinite(+l)?0:+l,p="",m=function(s,q){var r=Math.pow(10,q);return""+Math.round(s*r)/r};p=(i?m(h,i):""+Math.round(h)).split(".");if(p[0].length>3){p[0]=p[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,j)}if((p[1]||"").length<i){p[1]=p[1]||"";p[1]+=new Array(i-p[1].length+1).join("0")}return p.join(o)}})(jQuery);
